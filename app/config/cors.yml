nelmio_cors:
  defaults:
    allow_credentials: false
    allow_origin: []
    allow_headers: []
    allow_methods: []
    expose_headers: []
    max_age: 0
    hosts: []
    origin_regex: false
    forced_allow_origin_value: ~
  paths:
    # Public endpoint
    '^/graphql/':
      # Public means anyone can use it
      allow_origin: ['*']
      # Required header when we use file upload and form
      allow_headers: ['Content-Type', 'Authorization', 'Content-Length', 'X-Requested-With']
      # GraphQL uses only POST
      allow_methods: ['POST']
      # Cache for CORS checks
      max_age: 3600
    # Internal endpoint
    '^/graphql/internal':
      # We restrict the Origin header
      allow_origin: ['%router.request_context.scheme%://%router.request_context.host%']
      allow_headers: ['Content-Type', 'Authorization', 'Content-Length', 'X-Requested-With']
      allow_methods: ['POST']
      max_age: 3600
