swarrot:
    provider: pecl
    default_connection: rabbitmq
    connections:
        rabbitmq:
            host: 127.0.0.1
            port: 5672
            login: "%rabbitmq_login%"
            password: "%rabbitmq_password%"
            vhost: /
    messages_types:
        proposal.create:
            exchange: capco_direct_exchange
            routing_key: proposal_create
        proposal.update:
            exchange: capco_direct_exchange
            routing_key: proposal_update
        proposal.delete:
            exchange: capco_direct_exchange
            routing_key: proposal_delete
        comment.create:
            exchange: capco_direct_exchange
            routing_key: comment_create
        comment.update:
            exchange: capco_direct_exchange
            routing_key: comment_update
        comment.delete:
            exchange: capco_direct_exchange
            routing_key: comment_delete
    consumers:
        proposal_create:
            processor: proposal_create.processor
            middleware_stack:
                 - configurator: swarrot.processor.signal_handler
                 - configurator: swarrot.processor.doctrine_connection
                 - configurator: swarrot.processor.doctrine_object_manager
                 - configurator: swarrot.processor.exception_catcher
                 - configurator: swarrot.processor.retry
                   extras:
                       retry_attempts: 3
                       retry_exchange: 'retry'
                       retry_routing_key_pattern: 'proposal_create_retry_%%attempt%%'
        proposal_update:
            processor: proposal_update.processor
            middleware_stack:
                 - configurator: swarrot.processor.signal_handler
                 - configurator: swarrot.processor.doctrine_connection
                 - configurator: swarrot.processor.doctrine_object_manager
                 - configurator: swarrot.processor.exception_catcher
                 - configurator: swarrot.processor.retry
                   extras:
                       retry_attempts: 3
                       retry_exchange: 'retry'
                       retry_routing_key_pattern: 'proposal_update_retry_%%attempt%%'
        proposal_delete:
            processor: proposal_delete.processor
            middleware_stack:
                 - configurator: swarrot.processor.signal_handler
                 - configurator: swarrot.processor.doctrine_connection
                 - configurator: swarrot.processor.doctrine_object_manager
                 - configurator: swarrot.processor.exception_catcher
                 - configurator: swarrot.processor.retry
                   extras:
                       retry_attempts: 3
                       retry_exchange: 'retry'
                       retry_routing_key_pattern: 'proposal_delete_retry_%%attempt%%'
        comment_create:
            processor: comment_create.processor
            middleware_stack:
                 - configurator: swarrot.processor.signal_handler
                 - configurator: swarrot.processor.doctrine_connection
                 - configurator: swarrot.processor.doctrine_object_manager
                 - configurator: swarrot.processor.exception_catcher
                 - configurator: swarrot.processor.retry
                   extras:
                       retry_attempts: 3
                       retry_exchange: 'retry'
                       retry_routing_key_pattern: 'comment_create_retry_%%attempt%%'
        comment_update:
            processor: comment_update.processor
            middleware_stack:
                 - configurator: swarrot.processor.signal_handler
                 - configurator: swarrot.processor.doctrine_connection
                 - configurator: swarrot.processor.doctrine_object_manager
                 - configurator: swarrot.processor.exception_catcher
                 - configurator: swarrot.processor.retry
                   extras:
                       retry_attempts: 3
                       retry_exchange: 'retry'
                       retry_routing_key_pattern: 'comment_update_retry_%%attempt%%'
        comment_delete:
            processor: comment_delete.processor
            middleware_stack:
                 - configurator: swarrot.processor.signal_handler
                 - configurator: swarrot.processor.doctrine_connection
                 - configurator: swarrot.processor.doctrine_object_manager
                 - configurator: swarrot.processor.exception_catcher
                 - configurator: swarrot.processor.retry
                   extras:
                       retry_attempts: 3
                       retry_exchange: 'retry'
                       retry_routing_key_pattern: 'comment_delete_retry_%%attempt%%'
