dependencies:
    override:
        - composer install --no-interaction -vvv:
            timeout: 3600
    pre:
        - echo "memory_limit = 2048M" > ~/.phpenv/versions/$(phpenv global)/etc/conf.d/memory.ini
        - mv app/config/parameters.ci.yml app/config/parameters.yml
        - gem install bundler
        - bundle install --clean

deployment:
    preprod:
        branch: develop
        commands:
            - bundle exec cap preprod deploy

general:
    branches:
        only:
            - develop # list of branches to build

machine:
    php:
        version: 5.5.15

test:
    pre:
        - echo "memory_limit = 2048M" > ~/.phpenv/versions/$(phpenv global)/etc/conf.d/memory.ini

    override:
        - phpunit -c app -v
        - bin/phpspec run
