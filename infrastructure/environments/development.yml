application:
    environment:
        DOCKER_GID: 100
        BLACKFIRE_SERVER_ID: 4b6755d5-5dd0-4bd5-ba4e-596d0b6a410b
        BLACKFIRE_SERVER_TOKEN: 20ca64718723b634c82c7114d1483571042e763bff0951661da70a812cec83d7
        BLACKFIRE_LOG_LEVEL: 1
        BLACKFIRE_LOG_FILE: /tmp/blackfire.log
        BLACKFIRE_CLIENT_ID: ***REMOVED***
        BLACKFIRE_CLIENT_TOKEN: ***REMOVED***
        SYMFONY_INSTANCE_NAME: dev
    volumes:
        - ../../:/var/www
        - /var/run/docker.sock:/var/run/docker.sock
        - /usr/local/bin/docker:/usr/bin/docker
        - /etc/localtime:/etc/localtime:ro
    links:
        - database:database
        - elasticsearch:elasticsearch
        - kibana:kibana
        - redis:redis
        - seleniumhub:selenium
        - mailcatcher:mailcatchersmtp

builder:
    build: ../services/builder
    volumes:
        - ../../:/var/www
        - ~/Library/Caches/Composer:/home/capco/.composer
        - ~/Library/Caches/Yarn:/home/capco/.cache/yarn
        - ~/Library/Caches/Bower:/home/capco/.cache/bower
    command: echo "Use 'docker-compose run builder build' to build deps"

qarunner:
  build: ../services/qa-runner
  volumes:
    - ../../:/var/www

database:
    ports:
        - "3306:3306"

chrome:
   ports:
        - "5900:5900"

# You can also test on a different browser
# firefox:
#   image: selenium/node-firefox-debug:latest
#   links:
#     - seleniumhub:hub
#     - application:application
#   ports:
#     - "5901:5900"
