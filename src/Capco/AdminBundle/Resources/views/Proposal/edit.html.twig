{% extends 'SonataAdminBundle:CRUD:base_edit.html.twig' %}

{% block sonata_breadcrumb %}
{% endblock %}

{% block form %}
{% include '@CapcoApp/redux_store.html.twig' with {
  'project': admin.subject.proposalForm.step.getProject(),
  'data' : {
    'proposal': {
      'proposalsById': {
        (admin.subject.id) : {
          'selections': [],
          'status': admin.subject.status
          ? {
              'id': admin.subject.status.id,
              'name': admin.subject.status.name
            }
         : null
        }
      },
    }
  }
}
%}
{{ react_render_component('ProposalAdminPageApp', {
  'props': {
    'proposalId': admin.subject.id,
  },
  'rendering': 'client_side'
}) }}
{% endblock %}

{% block javascripts %}
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=***REMOVED***&libraries=places"></script>
<script>
    function waitForElementToDisplay(time) {
        if(document.getElementById("proposal-admin-page-tabs-pane-1")!=null) {
            jQuery('form').one('change', function () {
                window.onbeforeunload = function () {
                    return true;
                };
            });
            return;
        }
        else {
            setTimeout(function() {
                waitForElementToDisplay(time);
            }, time);
        }
    }

    waitForElementToDisplay(2000);
</script>
{{ parent() }}
{% endblock %}
