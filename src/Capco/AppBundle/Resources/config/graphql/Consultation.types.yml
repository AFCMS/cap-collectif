Consultation:
  type: object
  inherits: [Node, Step]
  config:
    interfaces: [Node, Step]
    description: 'A consultation'
    fields:
      kind:
        resolve: 'consultation'
      opinionCountShownBySection:
        type: 'Int'
      userHasVote:
        type: 'Boolean!'
        description: 'Whether the user has vote for a contribution in this consultation.'
        args:
          login:
            type: 'String!'
            description: "The user's login."
        resolve:
          '@=resolver("Capco\\AppBundle\\GraphQL\\Resolver\\Consultation\\ConsultationUserHasVoteResolver", [value, args])'
      votesCount:
        type: 'Int'
        description: 'The number of votes in this consultation.'
        deprecationReason:
          'In preparation for an upcoming change to the way we expose counters, this field will only be available inside a `votes` connection.'
      project:
        type: 'Project!'
        description: 'The project'
      projectId:
        type: 'String!'
        description: 'The id of the related project.'
      title:
        description: 'The title of the consultation.'
      titleHelpText:
        type: 'String'
      descriptionHelpText:
        type: 'String'
      contribuable:
        type: 'Boolean!'
        description: 'Contributions are allowed right now.'
        resolve: '@=value.canContribute()'
      sections:
        type: '[Section]'
        description: 'List of sections.'
        resolve: "@=resolver('consultation_sections', [value, args])"
      contributors:
        type: 'UserConnection!'
        description: 'A list of contributor associated with the consultation.'
        argsBuilder: 'Relay::Connection'
        resolve:
          '@=resolver("Capco\\AppBundle\\GraphQL\\Resolver\\Step\\StepContributorResolver", [value, args])'
      viewerOpinionsUnpublished:
        access: "@=hasRole('ROLE_USER')"
        type: 'OpinionConnection'
        argsBuilder: 'Relay::Connection'
        resolve:
          '@=resolver("Capco\\AppBundle\\GraphQL\\Resolver\\Consultation\\ConsultationViewerOpinionsUnpublishedResolver", [value, args, getUser()])'
      contributionConnection:
        type: 'ContributionConnection'
        argsBuilder: 'Relay::Connection'
        args:
          orderBy:
            type: 'ContributionOrder'
            description: 'Ordering options for contributions returned from the connection.'
            defaultValue: { field: POSITION, direction: DESC }
        resolve: '@=resolver("consultationContributionsRelay", [value, args])'
