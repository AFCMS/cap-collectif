imports:
  - { resource: services/listeners.yml }
  - { resource: services/repositories.yml }
  - { resource: services/resolvers.yml }
  - { resource: services/twig.yml }
  - { resource: services/validators.yml }
  - { resource: services/forms.yml }
  - { resource: services/processors.yml }
  - { resource: services/search.yml }
  - { resource: services/commands.yml }
  - { resource: services/utils.yml }
  - { resource: services/makers.yml }
  - { resource: services/graphql_mutations.yml }
  - { resource: services/graphql_resolvers.yml }
  - { resource: services/graphql_dataloaders.yml }
  - { resource: services/notifiers.yml }
  - { resource: services/elasticsearch.yml }
  - { resource: services/data_fixtures.yml }
  - { resource: services/helpers.yml }
  - { resource: services/synthesis.yml }

parameters:
  traits:
    selflinkable:
      interfaces:
        - Capco\AppBundle\Entity\Interfaces\SelfLinkableInterface
    votable:
      interfaces:
        - Capco\AppBundle\Entity\Interfaces\VotableInterface
  env(SYMFONY_DATABASE_DRIVER): pdo_mysql
  env(SYMFONY_DATABASE_HOST): 127.0.0.1
  env(SYMFONY_DATABASE_PORT): 3306
  env(SYMFONY_DATABASE_NAME): symfony
  env(SYMFONY_DATABASE_USER): root
  env(SYMFONY_DATABASE_PASSWORD): ~
  env(SYMFONY_RABBITMQ_LOGIN): guest
  env(SYMFONY_RABBITMQ_PASSWORD): guest
  env(SYMFONY_SAML_SP): oda
  env(SYMFONY_ELASTICSEARCH_HOST): 127.0.0.1
  env(SYMFONY_REDIS_HOST): 127.0.0.1
  env(SYMFONY_MAILER_USER): ~
  env(SYMFONY_MAILER_PASSWORD): ~
  env(SYMFONY_MAILER_HOST): mailcatchersmtp
  env(SYMFONY_MAILER_PORT): 25
  env(SYMFONY_LOCALE): fr-FR
  env(SYMFONY_SECRET): ***REMOVED***
  env(SYMFONY_USE_ASSETIC_CONTROLLER): true
  env(SYMFONY_FACEBOOK_APP_ID): ***REMOVED***
  env(SYMFONY_FACEBOOK_APP_SECRET): ***REMOVED***
  env(SYMFONY_GOOGLE_APP_ID):
    ***REMOVED***
  env(SYMFONY_GOOGLE_APP_SECRET): ***REMOVED***
  env(SYMFONY_JWT_TOKEN_TTL): 86400 # 24 hours
  env(SYMFONY_LANGUAGE_ANALYZER): french
  env(SYMFONY_REMEMBER_SECRET): ***REMOVED***
  env(SYMFONY_ROUTER__REQUEST_CONTEXT__HOST): capco.dev
  env(SYMFONY_ROUTER__REQUEST_CONTEXT__SCHEME): http
  env(SYMFONY_ASSETS_VERSION): v1
  env(SYMFONY_RECAPTCHA_PRIVATE_KEY): ***REMOVED***
  env(SYMFONY_TWILIO_SID): ***REMOVED***
  env(SYMFONY_TWILIO_TOKEN): ***REMOVED***
  env(SYMFONY_TWILIO_NUMBER): +***REMOVED***
  env(SYMFONY_DISABLE_MAIL_DELIVERY): false

services:
  import.csvtoarray:
    class: Capco\AppBundle\Helper\ConvertCsvToArray

  Capco\AppBundle\Controller\Site\DeveloperController:
    autowire: true

  Capco\AppBundle\Controller\Api\GraphQLController:
    autowire: true
    arguments:
      $batchParser: '@overblog_graphql.request_batch_parser'
      $requestParser: '@overblog_graphql.request_parser'

  redis_adapter:
    class: Capco\AppBundle\Adapter\RedisAdapter
    arguments: ['@snc_redis.default']

  Capco\AppBundle\Manager\RedisCacheManager:
    autowire: true
    arguments:
      $redisClient: '@snc_redis.default'

  Capco\AppBundle\Mailer\MailerService:
    autowire: true

  capco.diff.generator:
    class: Capco\AppBundle\Generator\DiffGenerator
    autowire: true

  geocoder.google_map:
    class: Geocoder\Provider\GoogleMaps
    autowire: true
    arguments:
      $useSsl: true
      $apiKey: '%google_maps_key_server%'

  curl.http_adapter:
    class: Ivory\HttpAdapter\CurlHttpAdapter

  ##################### SMS
  twilio.sms_sender:
    class: Capco\AppBundle\Sms\TwilioSmsSender
    arguments: ['%twilio_sid%', '%twilio_token%']

  sms.service:
    class: Capco\AppBundle\Sms\SmsService
    autowire: true
    arguments:
      $number: '%twilio_number%'
    public: true

  capco.canonicalizer:
    class: Capco\AppBundle\Utils\Canonicalizer

  Box\Spout\Writer\CSV\Writer:
    class: Box\Spout\Writer\CSV\Writer

  Capco\AppBundle\PublicApi\PublicApiKeyUserProvider:
    autowire: true
    public: true

  Capco\AppBundle\PublicApi\PublicApiKeyAuthenticator:
    autowire: true
    public: true