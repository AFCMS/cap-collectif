parameters:
    capco.site_parameter.repository.class: Capco\AppBundle\Repository\SiteParameterRepository
    capco.site_parameter.resolver.class: Capco\AppBundle\SiteParameter\Resolver
    capco.twig_extension.site_parameter.class: Capco\AppBundle\Twig\SiteParameterExtension
    capco.site_image.repository.class: Capco\AppBundle\Repository\SiteImageRepository
    capco.site_image.resolver.class: Capco\AppBundle\SiteImage\Resolver
    capco.twig_extension.site_image.class: Capco\AppBundle\Twig\SiteImageExtension
    capco.twig_extension.menu_url.class: Capco\AppBundle\Twig\MenuLinkExtension
    capco.twig_extension.feature_toggle.class: Capco\AppBundle\Twig\FeatureToggleExtension
    capco.notify.manager.class: Capco\AppBundle\Manager\Notify
    capco.toggle.manager.class: Capco\AppBundle\Toggle\Manager
    capco.toggle.listener.request.class: Capco\AppBundle\Toggle\RequestListener
    capco.blog.post.repository.class: Capco\AppBundle\Repository\PostRepository
    capco.site_color.repository.class: Capco\AppBundle\Repository\SiteColorRepository
    capco.site_color.resolver.class: Capco\AppBundle\SiteColor\Resolver
    capco.twig_extension.site_color.class: Capco\AppBundle\Twig\SiteColorExtension
    capco.email_sender.class: Capco\AppBundle\Services\EmailService

services:
    capco.site_parameter.repository:
        class: %capco.site_parameter.repository.class%
        factory_service: doctrine.orm.default_entity_manager
        factory_method: getRepository
        arguments:
            - Capco\AppBundle\Entity\SiteParameter

    capco.site_parameter.resolver:
        class: %capco.site_parameter.resolver.class%
        arguments:
            - @capco.site_parameter.repository
            - @logger

    capco.twig.site_parameter:
        class: %capco.twig_extension.site_parameter.class%
        arguments: [ @capco.site_parameter.resolver ]
        tags:
            - { name: twig.extension }

    ## Site paramèters for Image
    capco.site_image.repository:
        class: %capco.site_image.repository.class%
        factory_service: doctrine.orm.default_entity_manager
        factory_method: getRepository
        arguments:
            - Capco\AppBundle\Entity\SiteImage

    capco.site_image.resolver:
        class: %capco.site_image.resolver.class%
        arguments:
            - @capco.site_image.repository
            - @logger

    capco.twig.site_image:
        class: %capco.twig_extension.site_image.class%
        arguments: [ @capco.site_image.resolver ]
        tags:
            - { name: twig.extension }

    ## Site paramèters for colors
    capco.site_color.repository:
        class: %capco.site_color.repository.class%
        factory_service: doctrine.orm.default_entity_manager
        factory_method: getRepository
        arguments:
            - Capco\AppBundle\Entity\SiteColor

    capco.site_color.resolver:
        class: %capco.site_color.resolver.class%
        arguments:
            - @capco.site_color.repository
            - @logger

    capco.twig.site_color:
        class: %capco.twig_extension.site_color.class%
        arguments: [ @capco.site_color.resolver ]
        tags:
            - { name: twig.extension }

    ## Menu URL
    capco.twig.menu_url:
        class: %capco.twig_extension.menu_url.class%
        arguments: [ @router, @validator ]
        tags:
            - { name: twig.extension }

    capco.form.type_extension.media:
        class: Capco\AppBundle\Form\Extension\MediaTypeExtension
        tags:
            - { name: form.type_extension, alias: sonata_media_type }

    ## Service Notify - send mail
    capco.notify_manager:
        class:     %capco.notify.manager.class%
        arguments: [@capco.email_sender, @templating, @translator, @capco.site_parameter.resolver]

    ## Mandrill
    capco.email_sender:
        class:     %capco.email_sender.class%
        arguments: [@security.token_storage, @hip_mandrill.dispatcher]

    ## Toggle
    capco.toggle.manager:
        class:     %capco.toggle.manager.class%
        arguments: [@qandidate.toggle.manager, @qandidate.toggle.user_context_factory]

    capco.toggle.listener.request:
        class:     %capco.toggle.listener.request.class%
        arguments: [@capco.toggle.manager, @translator]
        tags:
            - { name: kernel.event_listener, event: kernel.request, method: onKernelRequest }

    capco.twig.feature_toggle:
        class:     %capco.twig_extension.feature_toggle.class%
        arguments: [@capco.toggle.manager]
        tags:
            - { name: twig.extension }

    capco.blog.post.repository:
        class:           "%capco.blog.post.repository.class%"
        factory_service: doctrine.orm.entity_manager
        factory_method:  getRepository
        arguments:       ['CapcoAppBundle:Post']

