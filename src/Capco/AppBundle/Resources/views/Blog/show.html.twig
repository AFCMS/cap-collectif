{% extends '@CapcoApp/Blog/index.html.twig' %}

{% block canonical_link %}{{ url('app_blog_show', {'slug': post.slug}) }}{% endblock %}

{% block title %}
    {{ parent() }} - {{ post.title }}
{% endblock %}

{% block jumbotron %}{% endblock %}

{% block body %}
    <div class="container">
        <h1><a href="{{ url('app_blog_show', {'slug': post.slug}) }}">{{ post.title | jolitypo() }}</a></h1>
        {% include 'CapcoAppBundle:Blog:_authors.html.twig' with {'authors': post.Authors, 'publishedAt': post.publishedAt} %}

        {%  if post.Media %}
            {% thumbnail post.Media, 'blockHeader' with {'title': post.Media.name, 'alt': post.Media.name, 'class': 'img-responsive'} %}
        {%  endif %}

        <div class="block">
            {{ post.body|raw | jolitypo() }}
        </div>

        {{ sonata_block_render({'type': 'capco.block.service.share_button'}, {
            'url': url('app_blog_show', {'slug': post.slug}),
            'title': post.title,
        }) }}

        {% if capco_comment_can_show(post) and post.commentsCount > 0 %}
            {{ render(controller('CapcoAppBundle:Comment:showComments', {'object': post})) }}
        {% endif %}

        {% if capco_comment_can_add(post) %}
            {{ render(controller('CapcoAppBundle:Comment:create', {'objectId': post.id, 'objectType': post.className})) }}
        {% endif %}
    </div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('js/readmore/readmore.js') }}"></script>
    <script type="text/javascript">
        $('.more').readmore({
            collapsedHeight: 98,
            moreLink: '<a href="#">{{ 'comment.read_more'|trans({}, 'CapcoAppBundle') }}</a>',
            lessLink: '<a href="#">{{ 'comment.read_less'|trans({}, 'CapcoAppBundle') }}</a>'
        });
    </script>
{% endblock %}

