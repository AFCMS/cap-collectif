{% extends '@CapcoApp/Consultation/show.html.twig' %}

{% block canonical_link %}{{ url('app_consultation_show_trashed', {'consultationSlug': consultation.slug}) }}{% endblock %}

{% block opinions_list %}
    {% set trashedNb = (arguments|length + opinions|length + sources|length) %}
    <div class="block  block--bordered">
        <div class="opinion  opinion--gray opinion--default">
            <div class="opinion__header  opinion__header--mobile-centered">
                <h2 class="pull-left  h4  opinion__header__title">{{ 'consultation.show.trashed.title'|trans({}, 'CapcoAppBundle') }} <span class="badge">{{ trashedNb }}</span></h2>
                <div class="pull-right  opinion__header__filter">
                </div>
            </div>
        </div>
        {% if trashedNb > 0 %}
            {% if(opinions|length > 0) %}
                <ul class="media-list  opinion__list">
                    <li class="bg-warning text-warning box text-center">
                        {{ 'consultation.show.trashed.text'|trans({}, 'CapcoAppBundle') }}
                    </li>
                    {% for opinion in opinions %}
                        {% include 'CapcoAppBundle:Opinion:blockOpinion.html.twig' with {'opinionType': opinion.opinionType, 'trashed': true} %}
                    {% endfor %}
                </ul>
            {% endif %}
            {% if arguments|length > 0 %}
                <ul class="media-list  opinion__list">
                    {% for argument in arguments %}
                        {% include 'CapcoAppBundle:Argument:blockArgument.html.twig' with {'trashed': true} %}
                    {% endfor %}
                </ul>
            {% endif %}
            {% if sources|length > 0 %}
                <ul class="media-list  opinion__list">
                    {% for source in sources %}
                        <li class="opinion  media  box" id="source{{ source.id }}">
                            {% include 'CapcoUserBundle:Avatar:avatar.html.twig' with { 'user': source.Author, 'link_classes': 'pull-left media-middle', format: 'avatar_source'} only %}
                            <div class="media-body">
                                <h4 class="media-heading h4" id="source{{ source.id }}"><span class="label label-info">{{ source.Category.title | capitalize }}</span>
                                    {% if source.Media %}
                                        <a href="{{ path('sonata_media_download', {'id': source.Media|sonata_urlsafeid }) }}">{{ source.title }}</a>
                                    {% endif %}
                                    {% if source.link %}
                                        <a href="{{ source.link }}" target="_blank">{{ source.title }}</a>
                                    {% endif %}
                                </h4>
                                <p>{{ 'source.trashed.linked_proposition' | trans({}, 'CapcoAppBundle') }} <a href="{{ path('app_consultation_show_opinion', {'consultationSlug': consultation.slug, 'opinionTypeSlug': source.Opinion.OpinionType.slug, 'opinionSlug': source.Opinion.slug}) }}">{{ source.Opinion.title }}</a></p>
                                <p class="excerpt">
                                    {{ source.body }}
                                </p>
                                <button disabled="disabled" class="btn  btn-default btn-xs"><i class="cap cap-hand-like-2"></i> {{ 'source.vote.submit'|trans({}, 'CapcoAppBundle') }}</button>
                                <span class="nb-votes">{{ source.voteCountSource }}</span>
                            </div>
                        </li>
                    {% endfor %}
                </ul>
            {% endif %}
        {% else %}
            <div class="consultation__empty-block  text-center">
                <p class="icon  cap-bubble-attention-6"></p>
                <p>{{ 'consultation.show.trashed.none'|trans({}, 'CapcoAppBundle') }}</p>
            </div>
        {% endif %}
    </div>
{% endblock %}
