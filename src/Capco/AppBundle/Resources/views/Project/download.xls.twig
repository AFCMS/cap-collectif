{% xlsdocument {
    'created': "now" | localizeddate('long', 'short', locale),
    'format': format,
    'title': title,
    'defaultStyle': {
        'font': {'size': '12', 'name': 'Arial'}
    },
} %}

    {% for sheet in sheets %}

        {% set title =  'project_download.sheets.' ~ sheet %}
        {% xlssheet title | trans({}, 'CapcoAppBundle') {
            'columnDimension': {
                'default': {
                    'width': 20,
                },
            },
        } %}

            {% xlsrow %}
                {% for header in headers[sheet] %}
                    {% xlscell {'style': {'font': {'bold': true} } } %}
                        {% if header is iterable and header.raw %}
                            {{ header.label }}
                        {% else %}
                            {% set label = 'project_download.label.' ~ header %}
                            {{ label | trans({}, 'CapcoAppBundle') | raw }}
                        {% endif %}
                    {% endxlscell %}
                {% endfor %}
            {% endxlsrow %}

            {% for item in data[sheet] %}
                {% xlsrow %}
                    {% for header in headers[sheet] %}
                        {% set key = header is iterable ? header.label : header %}
                        {% xlscell %}
                            {{ item[key] | raw }}
                        {% endxlscell %}
                    {% endfor %}
                {% endxlsrow %}
            {% endfor %}

        {% endxlssheet %}

    {% endfor %}

{% endxlsdocument %}
