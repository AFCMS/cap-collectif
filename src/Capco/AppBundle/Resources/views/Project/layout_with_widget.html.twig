{% extends '@CapcoApp/base.html.twig' %}

{% set showVotesWidget = currentStep.slug is defined and not currentStep.isPresentationStep() and capco_has_votable_step_not_future(project) and is_granted('ROLE_USER') %}
{% set page_class = showVotesWidget ? "has-vote-widget" : "" %}

{% block reduxStore %}
  {% include '@CapcoApp/redux_store.html.twig' with {'project': project} %}
{% endblock %}

{% block mainContent %}

    {% if showVotesWidget %}
      {{ react_intl_component('ProposalVoteBasketWidgetApp', {
          'props': {
            'image': media_public_url(capco_site_image_media('image.votes_bar'), 'default_small'),
            'votesPageUrl': path('app_project_show_user_votes', {'projectSlug': project.slug}),
          },
          'rendering': (app.user and not feature_is_active('server_side_rendering')) ? 'client_side' : 'both',
          })
      }}
    {% endif %}

    {{ parent() }}

{% endblock %}

{% block javascripts %}
    {{ parent() }}
{% endblock %}
