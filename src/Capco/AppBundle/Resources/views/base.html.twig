{% extends '@CapcoApp/layout.html.twig' %}

{% block mainContent %}
    {# Header  #}
    {% include '@CapcoApp/Default/header.html.twig' %}

    {% if app.request.hasPreviousSession %}
      <div id="symfony-flash-messages">
        {% for key, messages in app.session.flashbag.all() %}
            {% for message in messages %}
            <div class="alert alert-{{ key }} alert-dismissible  alert--no-radius" role="alert" style="margin-bottom: 0; text-align: center">
                <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">{{ 'global.alert.close'|trans({}, 'CapcoAppBundle') }}</span></button>
                <span>{% block error_message %}{{ message | trans({}, 'CapcoAppBundle') }}{% endblock %}</span>
            </div>
            {% endfor %}
        {% endfor %}
      </div>
    {% endif %}


    {# Main jumbotron for a primary marketing message or call to action #}
    {% block jumbotron %}{% endblock %}

    <div id="main" class="main" tabindex="-1">
        {% block body %}{% endblock %}
    </div>

    {# Footer #}
    <div id="cookie-banner" class="cookie-banner">
        <div class="col-sm-9">{{ 'performance-cookies-alert'|trans({}, 'CapcoAppBundle') }}</div>
        <div class="col-sm-3 d-flex justify-content-end">
            <a id="cookie-more-button" class="mr-10" name="cookie-more" href="{{ url('app_confidentialite') }}">{{ 'cookies-setting'|trans({}, 'CapcoAppBundle') }}</a>
            <div id="cookie-button-container"><button id="cookie-consent" class="btn btn-default btn-sm" >{{ 'ok-accept-everything'|trans({}, 'CapcoAppBundle') }}</button></div>
        </div>
    </div>

    {{ render(controller('CapcoAppBundle:Site/Default:footer')) }}

{% endblock %}

{% block javascripts %}
    {{ parent() }}
    {% set analytic_js = capco_site_parameter_value('snalytical-tracking-scripts-on-all-pages') %}
    <script type="text/javascript">
      /*  require('Resources/js/modernizr');
        {# remove when Piechart is rendered by VotePiechart component everywhere #}
        require('Resources/js/jsapi');
        require('Resources/js/googleCharts');
        window.locale = "{{ intl_locale() }}";
        //TODO XXX 
        var App = require('Resources/js/app').default;

        var cookieMonster = require('Resources/js/cookieMonster').default;
        window.executeAnalyticScript = function(){
            {% if null != analytic_js %}
              var script = document.createElement("script");
              script.innerHTML = '{{ analytic_js|e("js") }}';
              document.body.appendChild(script);
            {% endif %}
        };

        document.addEventListener('DOMContentLoaded', function(event) {
          cookieMonster.processCookieConsent();
        });

        if (!Modernizr.intl) {
            require('Resources/js/browserUpdate');
        }
*/
        $(window).on('load', function() {
            App.default.externalLinks();
            App.default.skipLinks();
        });
        $(function () {
          $('[data-toggle="tooltip"]').tooltip();
        });

        App.default.customModal('.modal--custom');
        App.default.video('.fancybox');
    </script>
    {% set client_js = capco_site_parameter_value('global.site.embed_js') %}
    {% if null != client_js %}
        {{ client_js|raw }}
    {% endif %}

{% endblock %}
