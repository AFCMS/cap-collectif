{% set page_class = "profile-page" %}
{% extends "CapcoUserBundle::layout.html.twig" %}

{% block canonical_link %}{{ url('capco_user_profile_show_all', {'slug': user.slug}) }}{% endblock %}

{% block metaTags %}
    {# OpenGraph doesn't support svg as image so no default avatar :'( #}
    {% set userMedia %}{% if user.Media %}{% path user.Media, 'avatar' %}{% endif %}{% endset %}
    {% include 'CapcoAppBundle:Default:meta.html.twig' with {
        'title':       'user.profile.show.title'|trans({'%name%': user.username }, 'CapcoAppBundle'),
        'description': user.biography,
        'url':         url('capco_user_profile_show_all', {'slug': user.slug}),
        'type':        'profile',
        'image':       userMedia
    } only %}
{% endblock %}

{% block title %}
    {{ parent() }} - {{ 'user.profile.show.title'|trans({'%name%': user.username }, 'CapcoAppBundle') }}
{% endblock %}

{% block jumbotron %}{% endblock %}

{% block fos_user_content %}

    {% include '@CapcoUser/Profile/showProfile.html.twig' %}

    <div class="container container--custom">
        <h2>{{ 'user.profile.show.opinions' | trans({}, 'CapcoAppBundle') }}</h2>
        {% include '@CapcoUser/Profile/opinions.html.twig' %}
    </div>

    <div class="container container--custom">
        <h2>{{ 'user.profile.show.opinions_versions' | trans({}, 'CapcoAppBundle') }}</h2>
        {% include '@CapcoUser/Profile/opinionVersions.html.twig' %}
    </div>

    <div class="container container--custom">
        <h2>{{ 'user.profile.show.arguments' | trans({}, 'CapcoAppBundle') }}</h2>
        {% include '@CapcoUser/Profile/arguments.html.twig' %}
    </div>

    <div class="container container--custom">
        <h2>{{ 'user.profile.show.sources' | trans({}, 'CapcoAppBundle') }}</h2>
        {% include '@CapcoUser/Profile/sources.html.twig' %}
    </div>

    <div class="container container--custom">
        <h2>{{ 'user.profile.show.proposals' | trans({}, 'CapcoAppBundle') }}</h2>
        {% include '@CapcoUser/Profile/proposals.html.twig' %}
    </div>

    {% if is_feature_enabled('ideas') %}
        <div class="container container--custom">
            <h2>{{ 'user.profile.show.ideas' | trans({}, 'CapcoAppBundle') }}</h2>
            {% include '@CapcoUser/Profile/ideas.html.twig' %}
        </div>
    {% endif %}

    {% if is_feature_enabled('ideas') or is_feature_enabled('calendar') or is_feature_enabled('blog') %}
        <div class="container container--custom">
            <h2>{{ 'user.profile.show.comments' | trans({}, 'CapcoAppBundle') }}</h2>
            {% include '@CapcoUser/Profile/comments.html.twig' %}
        </div>
    {% endif %}

    <div class="container container--custom">
        <h2>{{ 'user.profile.show.votes' | trans({}, 'CapcoAppBundle') }}</h2>
        {% include '@CapcoUser/Profile/votes.html.twig' %}
    </div>

{% endblock fos_user_content %}

{% block javascripts %}
    {{ parent() }}
    <script type="text/javascript">
        App.pieChart();

        $(window).on('load', function() {
            App.equalheight('.media--macro');
        });

        $(window).on('resize', function() {
            App.resized('.media--macro');
        });

    </script>
{% endblock %}
